// ==UserScript==
// @name         wiggy
// @namespace    https://aethre.co/
// @version      2025-01-25
// @downloadURL  https://github.com/thrilliams/wiggy/raw/main/wiggy.user.js
// @updateURL    https://github.com/thrilliams/wiggy/raw/main/wiggy.user.js
// @supportURL   https://github.com/thrilliams/wiggy/issues
// @description  makes whenisgood slightly more bearable
// @author       june
// @match        https://whenisgood.net/*/results/*
// @match        http://whenisgood.net/*/results/*
// @icon         http://whenisgood.net/favicon.ico
// @grant        unsafeWindow
// ==/UserScript==
"use strict";(()=>{var Z,y,je,Mt,D,Oe,Ue,le,Ve,ue,_e,ae,Et,z={},Be=[],St=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,he=Array.isArray;function F(t,e){for(var n in e)t[n]=e[n];return t}function fe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ct(t,e,n){var r,s,o,i={};for(o in e)o=="key"?r=e[o]:o=="ref"?s=e[o]:i[o]=e[o];if(arguments.length>2&&(i.children=arguments.length>3?Z.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)i[o]===void 0&&(i[o]=t.defaultProps[o]);return J(t,i,r,s,null)}function J(t,e,n,r,s){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++je,__i:-1,__u:0};return s==null&&y.vnode!=null&&y.vnode(o),o}function B(t){return t.children}function X(t,e){this.props=t,this.context=e}function V(t,e){if(e==null)return t.__?V(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?V(t):null}function Ke(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ke(t)}}function Fe(t){(!t.__d&&(t.__d=!0)&&D.push(t)&&!q.__r++||Oe!==y.debounceRendering)&&((Oe=y.debounceRendering)||Ue)(q)}function q(){var t,e,n,r,s,o,i,_;for(D.sort(le);t=D.shift();)t.__d&&(e=D.length,r=void 0,o=(s=(n=t).__v).__e,i=[],_=[],n.__P&&((r=F({},s)).__v=s.__v+1,y.vnode&&y.vnode(r),pe(n.__P,r,s,n.__n,n.__P.namespaceURI,32&s.__u?[o]:null,i,o??V(s),!!(32&s.__u),_),r.__v=s.__v,r.__.__k[r.__i]=r,Ye(i,r,_),r.__e!=o&&Ke(r)),D.length>e&&D.sort(le));q.__r=0}function ze(t,e,n,r,s,o,i,_,a,l,u){var c,f,h,d,b,v,g=r&&r.__k||Be,m=e.length;for(a=At(n,e,g,a,m),c=0;c<m;c++)(h=n.__k[c])!=null&&(f=h.__i===-1?z:g[h.__i]||z,h.__i=c,v=pe(t,h,f,s,o,i,_,a,l,u),d=h.__e,h.ref&&f.ref!=h.ref&&(f.ref&&de(f.ref,null,h),u.push(h.ref,h.__c||d,h)),b==null&&d!=null&&(b=d),4&h.__u||f.__k===h.__k?a=Ge(h,a,t):typeof h.type=="function"&&v!==void 0?a=v:d&&(a=d.nextSibling),h.__u&=-7);return n.__e=b,a}function At(t,e,n,r,s){var o,i,_,a,l,u=n.length,c=u,f=0;for(t.__k=new Array(s),o=0;o<s;o++)(i=e[o])!=null&&typeof i!="boolean"&&typeof i!="function"?(a=o+f,(i=t.__k[o]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?J(null,i,null,null,null):he(i)?J(B,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?J(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=t,i.__b=t.__b+1,_=null,(l=i.__i=It(i,n,a,c))!==-1&&(c--,(_=n[l])&&(_.__u|=2)),_==null||_.__v===null?(l==-1&&f--,typeof i.type!="function"&&(i.__u|=4)):l!=a&&(l==a-1?f--:l==a+1?f++:(l>a?f--:f++,i.__u|=4))):t.__k[o]=null;if(c)for(o=0;o<u;o++)(_=n[o])!=null&&!(2&_.__u)&&(_.__e==r&&(r=V(_)),Qe(_,_));return r}function Ge(t,e,n){var r,s;if(typeof t.type=="function"){for(r=t.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=t,e=Ge(r[s],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=V(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function It(t,e,n,r){var s,o,i=t.key,_=t.type,a=e[n];if(a===null||a&&i==a.key&&_===a.type&&!(2&a.__u))return n;if(r>(a!=null&&!(2&a.__u)?1:0))for(s=n-1,o=n+1;s>=0||o<e.length;){if(s>=0){if((a=e[s])&&!(2&a.__u)&&i==a.key&&_===a.type)return s;s--}if(o<e.length){if((a=e[o])&&!(2&a.__u)&&i==a.key&&_===a.type)return o;o++}}return-1}function De(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||St.test(e)?n:n+"px"}function Q(t,e,n,r,s){var o;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||De(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||De(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(Ve,"$1")),e=e.toLowerCase()in t||e=="onFocusOut"||e=="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=ue,t.addEventListener(e,o?ae:_e,o)):t.removeEventListener(e,o?ae:_e,o);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function We(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=ue++;else if(e.t<n.u)return;return n(y.event?y.event(e):e)}}}function pe(t,e,n,r,s,o,i,_,a,l){var u,c,f,h,d,b,v,g,m,S,C,j,$,M,A,L,U,E=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(a=!!(32&n.__u),o=[_=e.__e=n.__e]),(u=y.__b)&&u(e);e:if(typeof E=="function")try{if(g=e.props,m="prototype"in E&&E.prototype.render,S=(u=E.contextType)&&r[u.__c],C=u?S?S.props.value:u.__:r,n.__c?v=(c=e.__c=n.__c).__=c.__E:(m?e.__c=c=new E(g,C):(e.__c=c=new X(g,C),c.constructor=E,c.render=Tt),S&&S.sub(c),c.props=g,c.state||(c.state={}),c.context=C,c.__n=r,f=c.__d=!0,c.__h=[],c._sb=[]),m&&c.__s==null&&(c.__s=c.state),m&&E.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=F({},c.__s)),F(c.__s,E.getDerivedStateFromProps(g,c.__s))),h=c.props,d=c.state,c.__v=e,f)m&&E.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),m&&c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(m&&E.getDerivedStateFromProps==null&&g!==h&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(g,C),!c.__e&&(c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(g,c.__s,C)===!1||e.__v==n.__v)){for(e.__v!=n.__v&&(c.props=g,c.state=c.__s,c.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(T){T&&(T.__=e)}),j=0;j<c._sb.length;j++)c.__h.push(c._sb[j]);c._sb=[],c.__h.length&&i.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(g,c.__s,C),m&&c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(h,d,b)})}if(c.context=C,c.props=g,c.__P=t,c.__e=!1,$=y.__r,M=0,m){for(c.state=c.__s,c.__d=!1,$&&$(e),u=c.render(c.props,c.state,c.context),A=0;A<c._sb.length;A++)c.__h.push(c._sb[A]);c._sb=[]}else do c.__d=!1,$&&$(e),u=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++M<25);c.state=c.__s,c.getChildContext!=null&&(r=F(F({},r),c.getChildContext())),m&&!f&&c.getSnapshotBeforeUpdate!=null&&(b=c.getSnapshotBeforeUpdate(h,d)),_=ze(t,he(L=u!=null&&u.type===B&&u.key==null?u.props.children:u)?L:[L],e,n,r,s,o,i,_,a,l),c.base=e.__e,e.__u&=-161,c.__h.length&&i.push(c),v&&(c.__E=c.__=null)}catch(T){if(e.__v=null,a||o!=null)if(T.then){for(e.__u|=a?160:128;_&&_.nodeType==8&&_.nextSibling;)_=_.nextSibling;o[o.indexOf(_)]=null,e.__e=_}else for(U=o.length;U--;)fe(o[U]);else e.__e=n.__e,e.__k=n.__k;y.__e(T,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):_=e.__e=Lt(n.__e,e,n,r,s,o,i,a,l);return(u=y.diffed)&&u(e),128&e.__u?void 0:_}function Ye(t,e,n){for(var r=0;r<n.length;r++)de(n[r],n[++r],n[++r]);y.__c&&y.__c(e,t),t.some(function(s){try{t=s.__h,s.__h=[],t.some(function(o){o.call(s)})}catch(o){y.__e(o,s.__v)}})}function Lt(t,e,n,r,s,o,i,_,a){var l,u,c,f,h,d,b,v=n.props,g=e.props,m=e.type;if(m=="svg"?s="http://www.w3.org/2000/svg":m=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),o!=null){for(l=0;l<o.length;l++)if((h=o[l])&&"setAttribute"in h==!!m&&(m?h.localName==m:h.nodeType==3)){t=h,o[l]=null;break}}if(t==null){if(m==null)return document.createTextNode(g);t=document.createElementNS(s,m,g.is&&g),_&&(y.__m&&y.__m(e,o),_=!1),o=null}if(m===null)v===g||_&&t.data===g||(t.data=g);else{if(o=o&&Z.call(t.childNodes),v=n.props||z,!_&&o!=null)for(v={},l=0;l<t.attributes.length;l++)v[(h=t.attributes[l]).name]=h.value;for(l in v)if(h=v[l],l!="children"){if(l=="dangerouslySetInnerHTML")c=h;else if(!(l in g)){if(l=="value"&&"defaultValue"in g||l=="checked"&&"defaultChecked"in g)continue;Q(t,l,null,h,s)}}for(l in g)h=g[l],l=="children"?f=h:l=="dangerouslySetInnerHTML"?u=h:l=="value"?d=h:l=="checked"?b=h:_&&typeof h!="function"||v[l]===h||Q(t,l,h,v[l],s);if(u)_||c&&(u.__html===c.__html||u.__html===t.innerHTML)||(t.innerHTML=u.__html),e.__k=[];else if(c&&(t.innerHTML=""),ze(t,he(f)?f:[f],e,n,r,m=="foreignObject"?"http://www.w3.org/1999/xhtml":s,o,i,o?o[0]:n.__k&&V(n,0),_,a),o!=null)for(l=o.length;l--;)fe(o[l]);_||(l="value",m=="progress"&&d==null?t.removeAttribute("value"):d!==void 0&&(d!==t[l]||m=="progress"&&!d||m=="option"&&d!==v[l])&&Q(t,l,d,v[l],s),l="checked",b!==void 0&&b!==t[l]&&Q(t,l,b,v[l],s))}return t}function de(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(s){y.__e(s,n)}}function Qe(t,e,n){var r,s;if(y.unmount&&y.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||de(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){y.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(s=0;s<r.length;s++)r[s]&&Qe(r[s],e,n||typeof t.type!="function");n||fe(t.__e),t.__c=t.__=t.__e=void 0}function Tt(t,e,n){return this.constructor(t,n)}function Je(t,e,n){var r,s,o,i;e==document&&(e=document.documentElement),y.__&&y.__(t,e),s=(r=typeof n=="function")?null:n&&n.__k||e.__k,o=[],i=[],pe(e,t=(!r&&n||e).__k=Ct(B,null,[t]),s||z,z,e.namespaceURI,!r&&n?[n]:s?null:e.firstChild?Z.call(e.childNodes):null,o,!r&&n?n:s?s.__e:e.firstChild,r,i),Ye(o,t,i)}Z=Be.slice,y={__e:function(t,e,n,r){for(var s,o,i;e=e.__;)if((s=e.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(t)),i=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(t,r||{}),i=s.__d),i)return s.__E=s}catch(_){t=_}throw t}},je=0,Mt=function(t){return t!=null&&t.constructor==null},X.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=F({},this.state),typeof t=="function"&&(t=t(F({},n),this.props)),t&&F(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Fe(this))},X.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Fe(this))},X.prototype.render=B,D=[],Ue=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,le=function(t,e){return t.__v.__b-e.__v.__b},q.__r=0,Ve=/(PointerCapture)$|Capture$/i,ue=0,_e=We(!1),ae=We(!0),Et=0;var me,x,ge,Xe,ye=0,ot=[],k=y,qe=k.__b,Ze=k.__r,et=k.diffed,tt=k.__c,nt=k.unmount,rt=k.__;function Rt(t,e){k.__h&&k.__h(x,t,ye||e),ye=0;var n=x.__H||(x.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function te(t){return ye=1,Nt(it,t)}function Nt(t,e,n){var r=Rt(me++,2);if(r.t=t,!r.__c&&(r.__=[n?n(e):it(void 0,e),function(_){var a=r.__N?r.__N[0]:r.__[0],l=r.t(a,_);a!==l&&(r.__N=[l,r.__[1]],r.__c.setState({}))}],r.__c=x,!x.u)){var s=function(_,a,l){if(!r.__c.__H)return!0;var u=r.__c.__H.__.filter(function(f){return!!f.__c});if(u.every(function(f){return!f.__N}))return!o||o.call(this,_,a,l);var c=r.__c.props!==_;return u.forEach(function(f){if(f.__N){var h=f.__[0];f.__=f.__N,f.__N=void 0,h!==f.__[0]&&(c=!0)}}),o&&o.call(this,_,a,l)||c};x.u=!0;var o=x.shouldComponentUpdate,i=x.componentWillUpdate;x.componentWillUpdate=function(_,a,l){if(this.__e){var u=o;o=void 0,s(_,a,l),o=u}i&&i.call(this,_,a,l)},x.shouldComponentUpdate=s}return r.__N||r.__}function Pt(){for(var t;t=ot.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(ee),t.__H.__h.forEach(ve),t.__H.__h=[]}catch(e){t.__H.__h=[],k.__e(e,t.__v)}}k.__b=function(t){x=null,qe&&qe(t)},k.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),rt&&rt(t,e)},k.__r=function(t){Ze&&Ze(t),me=0;var e=(x=t.__c).__H;e&&(ge===x?(e.__h=[],x.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(ee),e.__h.forEach(ve),e.__h=[],me=0)),ge=x},k.diffed=function(t){et&&et(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(ot.push(e)!==1&&Xe===k.requestAnimationFrame||((Xe=k.requestAnimationFrame)||$t)(Pt)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),ge=x=null},k.__c=function(t,e){e.some(function(n){try{n.__h.forEach(ee),n.__h=n.__h.filter(function(r){return!r.__||ve(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],k.__e(r,n.__v)}}),tt&&tt(t,e)},k.unmount=function(t){nt&&nt(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{ee(r)}catch(s){e=s}}),n.__H=void 0,e&&k.__e(e,n.__v))};var st=typeof requestAnimationFrame=="function";function $t(t){var e,n=function(){clearTimeout(r),st&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);st&&(e=requestAnimationFrame(n))}function ee(t){var e=x,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),x=e}function ve(t){var e=x;t.__c=t.__(),x=e}function it(t,e){return typeof e=="function"?e(t):e}function ct(t){let e=t.querySelector(".cantCount"),n=e.querySelector("img");if(n!==null){let[s,o]=n.src.match(/dot(\d)\.gif$/);return parseInt(o)}let r=e.textContent;return parseInt(r)||0}function ne(){let t=[...document.querySelectorAll(".slot")],e=t.map(r=>ct(r)),n=Math.max(...e);for(let r in t){let s=t[r],o=e[r]/n||0,i=s.querySelector(".cantCount").style;i!==void 0&&(i.display="none"),s.style.backgroundColor=`color-mix(in srgb, #ff0000 ${Math.floor(o*100)}%, #00ff00)`}}function lt(){unsafeWindow.paintCanDos(),ne()}function H(t){return Array.isArray?Array.isArray(t):gt(t)==="[object Array]"}var Ht=1/0;function Ot(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-Ht?"-0":e}function Ft(t){return t==null?"":Ot(t)}function N(t){return typeof t=="string"}function pt(t){return typeof t=="number"}function Dt(t){return t===!0||t===!1||Wt(t)&&gt(t)=="[object Boolean]"}function dt(t){return typeof t=="object"}function Wt(t){return dt(t)&&t!==null}function I(t){return t!=null}function be(t){return!t.trim().length}function gt(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}var jt="Incorrect 'index' type",Ut=t=>`Invalid value for key ${t}`,Vt=t=>`Pattern length exceeds max of ${t}.`,Bt=t=>`Missing ${t} property in key`,Kt=t=>`Property 'weight' in key '${t}' must be a positive integer`,_t=Object.prototype.hasOwnProperty,xe=class{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(r=>{let s=mt(r);this._keys.push(s),this._keyMap[s.id]=s,n+=s.weight}),this._keys.forEach(r=>{r.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function mt(t){let e=null,n=null,r=null,s=1,o=null;if(N(t)||H(t))r=t,e=at(t),n=ke(t);else{if(!_t.call(t,"name"))throw new Error(Bt("name"));let i=t.name;if(r=i,_t.call(t,"weight")&&(s=t.weight,s<=0))throw new Error(Kt(i));e=at(i),n=ke(i),o=t.getFn}return{path:e,id:n,weight:s,src:r,getFn:o}}function at(t){return H(t)?t:t.split(".")}function ke(t){return H(t)?t.join("."):t}function zt(t,e){let n=[],r=!1,s=(o,i,_)=>{if(I(o))if(!i[_])n.push(o);else{let a=i[_],l=o[a];if(!I(l))return;if(_===i.length-1&&(N(l)||pt(l)||Dt(l)))n.push(Ft(l));else if(H(l)){r=!0;for(let u=0,c=l.length;u<c;u+=1)s(l[u],i,_+1)}else i.length&&s(l,i,_+1)}};return s(t,N(e)?e.split("."):e,0),r?n:n[0]}var Gt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Yt={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},Qt={location:0,threshold:.6,distance:100},Jt={useExtendedSearch:!1,getFn:zt,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},p={...Yt,...Gt,...Qt,...Jt},Xt=/[^ ]+/g;function qt(t=1,e=3){let n=new Map,r=Math.pow(10,e);return{get(s){let o=s.match(Xt).length;if(n.has(o))return n.get(o);let i=1/Math.pow(o,.5*t),_=parseFloat(Math.round(i*r)/r);return n.set(o,_),_},clear(){n.clear()}}}var G=class{constructor({getFn:e=p.getFn,fieldNormWeight:n=p.fieldNormWeight}={}){this.norm=qt(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,N(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){let n=this.size();N(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!I(e)||be(e))return;let r={v:e,i:n,n:this.norm.get(e)};this.records.push(r)}_addObject(e,n){let r={i:n,$:{}};this.keys.forEach((s,o)=>{let i=s.getFn?s.getFn(e):this.getFn(e,s.path);if(I(i)){if(H(i)){let _=[],a=[{nestedArrIndex:-1,value:i}];for(;a.length;){let{nestedArrIndex:l,value:u}=a.pop();if(I(u))if(N(u)&&!be(u)){let c={v:u,i:l,n:this.norm.get(u)};_.push(c)}else H(u)&&u.forEach((c,f)=>{a.push({nestedArrIndex:f,value:c})})}r.$[o]=_}else if(N(i)&&!be(i)){let _={v:i,n:this.norm.get(i)};r.$[o]=_}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}};function yt(t,e,{getFn:n=p.getFn,fieldNormWeight:r=p.fieldNormWeight}={}){let s=new G({getFn:n,fieldNormWeight:r});return s.setKeys(t.map(mt)),s.setSources(e),s.create(),s}function Zt(t,{getFn:e=p.getFn,fieldNormWeight:n=p.fieldNormWeight}={}){let{keys:r,records:s}=t,o=new G({getFn:e,fieldNormWeight:n});return o.setKeys(r),o.setIndexRecords(s),o}function re(t,{errors:e=0,currentLocation:n=0,expectedLocation:r=0,distance:s=p.distance,ignoreLocation:o=p.ignoreLocation}={}){let i=e/t.length;if(o)return i;let _=Math.abs(r-n);return s?i+_/s:_?1:i}function en(t=[],e=p.minMatchCharLength){let n=[],r=-1,s=-1,o=0;for(let i=t.length;o<i;o+=1){let _=t[o];_&&r===-1?r=o:!_&&r!==-1&&(s=o-1,s-r+1>=e&&n.push([r,s]),r=-1)}return t[o-1]&&o-r>=e&&n.push([r,o-1]),n}var W=32;function tn(t,e,n,{location:r=p.location,distance:s=p.distance,threshold:o=p.threshold,findAllMatches:i=p.findAllMatches,minMatchCharLength:_=p.minMatchCharLength,includeMatches:a=p.includeMatches,ignoreLocation:l=p.ignoreLocation}={}){if(e.length>W)throw new Error(Vt(W));let u=e.length,c=t.length,f=Math.max(0,Math.min(r,c)),h=o,d=f,b=_>1||a,v=b?Array(c):[],g;for(;(g=t.indexOf(e,d))>-1;){let M=re(e,{currentLocation:g,expectedLocation:f,distance:s,ignoreLocation:l});if(h=Math.min(M,h),d=g+u,b){let A=0;for(;A<u;)v[g+A]=1,A+=1}}d=-1;let m=[],S=1,C=u+c,j=1<<u-1;for(let M=0;M<u;M+=1){let A=0,L=C;for(;A<L;)re(e,{errors:M,currentLocation:f+L,expectedLocation:f,distance:s,ignoreLocation:l})<=h?A=L:C=L,L=Math.floor((C-A)/2+A);C=L;let U=Math.max(1,f-L+1),E=i?c:Math.min(f+L,c)+u,T=Array(E+2);T[E+1]=(1<<M)-1;for(let R=E;R>=U;R-=1){let Y=R-1,He=n[t.charAt(Y)];if(b&&(v[Y]=+!!He),T[R]=(T[R+1]<<1|1)&He,M&&(T[R]|=(m[R+1]|m[R])<<1|1|m[R+1]),T[R]&j&&(S=re(e,{errors:M,currentLocation:Y,expectedLocation:f,distance:s,ignoreLocation:l}),S<=h)){if(h=S,d=Y,d<=f)break;U=Math.max(1,2*f-d)}}if(re(e,{errors:M+1,currentLocation:f,expectedLocation:f,distance:s,ignoreLocation:l})>h)break;m=T}let $={isMatch:d>=0,score:Math.max(.001,S)};if(b){let M=en(v,_);M.length?a&&($.indices=M):$.isMatch=!1}return $}function nn(t){let e={};for(let n=0,r=t.length;n<r;n+=1){let s=t.charAt(n);e[s]=(e[s]||0)|1<<r-n-1}return e}var se=class{constructor(e,{location:n=p.location,threshold:r=p.threshold,distance:s=p.distance,includeMatches:o=p.includeMatches,findAllMatches:i=p.findAllMatches,minMatchCharLength:_=p.minMatchCharLength,isCaseSensitive:a=p.isCaseSensitive,ignoreLocation:l=p.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:s,includeMatches:o,findAllMatches:i,minMatchCharLength:_,isCaseSensitive:a,ignoreLocation:l},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;let u=(f,h)=>{this.chunks.push({pattern:f,alphabet:nn(f),startIndex:h})},c=this.pattern.length;if(c>W){let f=0,h=c%W,d=c-h;for(;f<d;)u(this.pattern.substr(f,W),f),f+=W;if(h){let b=c-W;u(this.pattern.substr(b),b)}}else u(this.pattern,0)}searchIn(e){let{isCaseSensitive:n,includeMatches:r}=this.options;if(n||(e=e.toLowerCase()),this.pattern===e){let d={isMatch:!0,score:0};return r&&(d.indices=[[0,e.length-1]]),d}let{location:s,distance:o,threshold:i,findAllMatches:_,minMatchCharLength:a,ignoreLocation:l}=this.options,u=[],c=0,f=!1;this.chunks.forEach(({pattern:d,alphabet:b,startIndex:v})=>{let{isMatch:g,score:m,indices:S}=tn(e,d,b,{location:s+v,distance:o,threshold:i,findAllMatches:_,minMatchCharLength:a,includeMatches:r,ignoreLocation:l});g&&(f=!0),c+=m,g&&S&&(u=[...u,...S])});let h={isMatch:f,score:f?c/this.chunks.length:1};return f&&r&&(h.indices=u),h}},P=class{constructor(e){this.pattern=e}static isMultiMatch(e){return ut(e,this.multiRegex)}static isSingleMatch(e){return ut(e,this.singleRegex)}search(){}};function ut(t,e){let n=t.match(e);return n?n[1]:null}var we=class extends P{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){let n=e===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}},Me=class extends P{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){let r=e.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}},Ee=class extends P{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){let n=e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}},Se=class extends P{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){let n=!e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}},Ce=class extends P{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){let n=e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},Ae=class extends P{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){let n=!e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}},oe=class extends P{constructor(e,{location:n=p.location,threshold:r=p.threshold,distance:s=p.distance,includeMatches:o=p.includeMatches,findAllMatches:i=p.findAllMatches,minMatchCharLength:_=p.minMatchCharLength,isCaseSensitive:a=p.isCaseSensitive,ignoreLocation:l=p.ignoreLocation}={}){super(e),this._bitapSearch=new se(e,{location:n,threshold:r,distance:s,includeMatches:o,findAllMatches:i,minMatchCharLength:_,isCaseSensitive:a,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}},ie=class extends P{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n=0,r,s=[],o=this.pattern.length;for(;(r=e.indexOf(this.pattern,n))>-1;)n=r+o,s.push([r,n-1]);let i=!!s.length;return{isMatch:i,score:i?0:1,indices:s}}},Ie=[we,ie,Ee,Se,Ae,Ce,Me,oe],ht=Ie.length,rn=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,sn="|";function on(t,e={}){return t.split(sn).map(n=>{let r=n.trim().split(rn).filter(o=>o&&!!o.trim()),s=[];for(let o=0,i=r.length;o<i;o+=1){let _=r[o],a=!1,l=-1;for(;!a&&++l<ht;){let u=Ie[l],c=u.isMultiMatch(_);c&&(s.push(new u(c,e)),a=!0)}if(!a)for(l=-1;++l<ht;){let u=Ie[l],c=u.isSingleMatch(_);if(c){s.push(new u(c,e));break}}}return s})}var cn=new Set([oe.type,ie.type]),Le=class{constructor(e,{isCaseSensitive:n=p.isCaseSensitive,includeMatches:r=p.includeMatches,minMatchCharLength:s=p.minMatchCharLength,ignoreLocation:o=p.ignoreLocation,findAllMatches:i=p.findAllMatches,location:_=p.location,threshold:a=p.threshold,distance:l=p.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:r,minMatchCharLength:s,findAllMatches:i,ignoreLocation:o,location:_,threshold:a,distance:l},this.pattern=n?e:e.toLowerCase(),this.query=on(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){let n=this.query;if(!n)return{isMatch:!1,score:1};let{includeMatches:r,isCaseSensitive:s}=this.options;e=s?e:e.toLowerCase();let o=0,i=[],_=0;for(let a=0,l=n.length;a<l;a+=1){let u=n[a];i.length=0,o=0;for(let c=0,f=u.length;c<f;c+=1){let h=u[c],{isMatch:d,indices:b,score:v}=h.search(e);if(d){if(o+=1,_+=v,r){let g=h.constructor.type;cn.has(g)?i=[...i,...b]:i.push(b)}}else{_=0,o=0,i.length=0;break}}if(o){let c={isMatch:!0,score:_/o};return r&&(c.indices=i),c}}return{isMatch:!1,score:1}}},Te=[];function ln(...t){Te.push(...t)}function Re(t,e){for(let n=0,r=Te.length;n<r;n+=1){let s=Te[n];if(s.condition(t,e))return new s(t,e)}return new se(t,e)}var ce={AND:"$and",OR:"$or"},Ne={PATH:"$path",PATTERN:"$val"},Pe=t=>!!(t[ce.AND]||t[ce.OR]),_n=t=>!!t[Ne.PATH],an=t=>!H(t)&&dt(t)&&!Pe(t),ft=t=>({[ce.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function vt(t,e,{auto:n=!0}={}){let r=s=>{let o=Object.keys(s),i=_n(s);if(!i&&o.length>1&&!Pe(s))return r(ft(s));if(an(s)){let a=i?s[Ne.PATH]:o[0],l=i?s[Ne.PATTERN]:s[a];if(!N(l))throw new Error(Ut(a));let u={keyId:ke(a),pattern:l};return n&&(u.searcher=Re(l,e)),u}let _={children:[],operator:o[0]};return o.forEach(a=>{let l=s[a];H(l)&&l.forEach(u=>{_.children.push(r(u))})}),_};return Pe(t)||(t=ft(t)),r(t)}function un(t,{ignoreFieldNorm:e=p.ignoreFieldNorm}){t.forEach(n=>{let r=1;n.matches.forEach(({key:s,norm:o,score:i})=>{let _=s?s.weight:null;r*=Math.pow(i===0&&_?Number.EPSILON:i,(_||1)*(e?1:o))}),n.score=r})}function hn(t,e){let n=t.matches;e.matches=[],I(n)&&n.forEach(r=>{if(!I(r.indices)||!r.indices.length)return;let{indices:s,value:o}=r,i={indices:s,value:o};r.key&&(i.key=r.key.src),r.idx>-1&&(i.refIndex=r.idx),e.matches.push(i)})}function fn(t,e){e.score=t.score}function pn(t,e,{includeMatches:n=p.includeMatches,includeScore:r=p.includeScore}={}){let s=[];return n&&s.push(hn),r&&s.push(fn),t.map(o=>{let{idx:i}=o,_={item:e[i],refIndex:i};return s.length&&s.forEach(a=>{a(o,_)}),_})}var O=class{constructor(e,n={},r){this.options={...p,...n},this.options.useExtendedSearch,this._keyStore=new xe(this.options.keys),this.setCollection(e,r)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof G))throw new Error(jt);this._myIndex=n||yt(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){I(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){let n=[];for(let r=0,s=this._docs.length;r<s;r+=1){let o=this._docs[r];e(o,r)&&(this.removeAt(r),r-=1,s-=1,n.push(o))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){let{includeMatches:r,includeScore:s,shouldSort:o,sortFn:i,ignoreFieldNorm:_}=this.options,a=N(e)?N(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return un(a,{ignoreFieldNorm:_}),o&&a.sort(i),pt(n)&&n>-1&&(a=a.slice(0,n)),pn(a,this._docs,{includeMatches:r,includeScore:s})}_searchStringList(e){let n=Re(e,this.options),{records:r}=this._myIndex,s=[];return r.forEach(({v:o,i,n:_})=>{if(!I(o))return;let{isMatch:a,score:l,indices:u}=n.searchIn(o);a&&s.push({item:o,idx:i,matches:[{score:l,value:o,norm:_,indices:u}]})}),s}_searchLogical(e){let n=vt(e,this.options),r=(_,a,l)=>{if(!_.children){let{keyId:c,searcher:f}=_,h=this._findMatches({key:this._keyStore.get(c),value:this._myIndex.getValueForItemAtKeyId(a,c),searcher:f});return h&&h.length?[{idx:l,item:a,matches:h}]:[]}let u=[];for(let c=0,f=_.children.length;c<f;c+=1){let h=_.children[c],d=r(h,a,l);if(d.length)u.push(...d);else if(_.operator===ce.AND)return[]}return u},s=this._myIndex.records,o={},i=[];return s.forEach(({$:_,i:a})=>{if(I(_)){let l=r(n,_,a);l.length&&(o[a]||(o[a]={idx:a,item:_,matches:[]},i.push(o[a])),l.forEach(({matches:u})=>{o[a].matches.push(...u)}))}}),i}_searchObjectList(e){let n=Re(e,this.options),{keys:r,records:s}=this._myIndex,o=[];return s.forEach(({$:i,i:_})=>{if(!I(i))return;let a=[];r.forEach((l,u)=>{a.push(...this._findMatches({key:l,value:i[u],searcher:n}))}),a.length&&o.push({idx:_,item:i,matches:a})}),o}_findMatches({key:e,value:n,searcher:r}){if(!I(n))return[];let s=[];if(H(n))n.forEach(({v:o,i,n:_})=>{if(!I(o))return;let{isMatch:a,score:l,indices:u}=r.searchIn(o);a&&s.push({score:l,key:e,value:o,idx:i,norm:_,indices:u})});else{let{v:o,n:i}=n,{isMatch:_,score:a,indices:l}=r.searchIn(o);_&&s.push({score:a,key:e,value:o,norm:i,indices:l})}return s}};O.version="7.0.0";O.createIndex=yt;O.parseIndex=Zt;O.config=p;O.parseQuery=vt;ln(Le);var K=new Map(Object.keys(unsafeWindow.respondents).map(t=>[t.slice(1),unsafeWindow.respondents[t]])),$e=[...K.keys()],bt=new O(Object.keys(unsafeWindow.respondents).map(t=>unsafeWindow.respondents[t]),{keys:["name"],threshold:.2,includeScore:!0});var dn=0,Ln=Array.isArray;function w(t,e,n,r,s,o){e||(e={});var i,_,a=e;if("ref"in a)for(_ in a={},e)_=="ref"?i=e[_]:a[_]=e[_];var l={type:t,props:a,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--dn,__i:-1,__u:0,__source:s,__self:o};if(typeof t=="function"&&(i=t.defaultProps))for(_ in i)a[_]===void 0&&(a[_]=i[_]);return y.vnode&&y.vnode(l),l}function xt({id:t,included:e,setIncluded:n}){let r=K.get(t);return w("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[w("span",{id:t,style:{cursor:"pointer"},onClick:()=>{let s=document.createElement("div");s.id=t,unsafeWindow.clickRespondent(s)},children:r?.name}),w("input",{type:"checkbox",checked:e,onChange:s=>n(s.currentTarget.checked)})]})}function kt(){let[t,e]=te($e),n=l=>{for(let[u,c]of K.entries())c.included=l.includes(u);e(l),lt()},r=(l,u)=>{n(u?[...t,l]:t.filter(c=>c!==l))},[s,o]=te(""),[i,_]=te("fuse"),a=s.length>0?bt.search(s).map(l=>l.item):[...K.values()];return i==="name"&&a.sort((l,u)=>l.name.localeCompare(u.name)),i==="date"&&a.sort((l,u)=>new Date(l.updated).getTime()-new Date(u.updated).getTime()),w("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[w("button",{onClick:()=>n($e.filter(l=>!t.includes(l))),children:"toggle all"}),w("select",{onChange:l=>_(l.currentTarget.value),children:[w("option",{value:"name",selected:i==="name",children:"sort by name"}),w("option",{value:"date",selected:i==="date",children:"sort by date"}),w("option",{value:"fuse",selected:i==="fuse",children:"sort by relevance"})]}),w("input",{type:"text",placeholder:"search...",value:s,onInput:l=>o(l.currentTarget.value)}),w("hr",{style:{width:"100%",margin:"0"}}),a.map(({id:l})=>w(xt,{id:l,included:t.includes(l),setIncluded:u=>r(l,u)},l))]})}function wt(){let t=document.querySelector(".respondents");for(let r of document.querySelectorAll(".respondents > :not(.respondentPopup)"))r.remove();let e=document.createElement("div");e.style.marginLeft="10px",t.after(e);for(let r of document.querySelectorAll(".slot"))r.style.minWidth="90px";let n=unsafeWindow.outTd;return unsafeWindow.outTd=()=>{n();for(let r of Object.keys(unsafeWindow.respondents))document.getElementById(r.slice(1)).className=""},unsafeWindow.paintRespondents=()=>{},e}var gn=wt();Je(w(kt,{}),gn);ne();})();
